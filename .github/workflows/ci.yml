name: ğŸ§ª Go CI Pipeline

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

jobs:
  build-and-test:
    name: Build & Test Go Application
    runs-on: ubuntu-latest

    steps:
      # ğŸ› ï¸ 1. Repository auschecken
      - name: Checkout repository
        uses: actions/checkout@v4

      # ğŸ§° 2. Go einrichten
      - name: Set up Go
        uses: actions/setup-go@v5
        with:
          go-version: '1.22'

      # ğŸ“¦ 3. Dependencies laden
      - name: Install dependencies
        run: go mod tidy

      # ğŸ” 4. Statische Codeanalyse
      - name: Run vet & fmt check
        run: |
          go vet ./...
          test -z "$(gofmt -l .)" || (echo "Code ist nicht formatiert"; gofmt -d .; exit 1)

      # ğŸ§± 5. Build
      - name: Build application
        run: go build -v ./...

      # âœ… 6. Tests (optional â€“ kann leer bleiben, wenn du noch keine hast)
      - name: Run tests
        run: go test -v ./... || echo "Keine Tests vorhanden oder Ã¼bersprungen"

